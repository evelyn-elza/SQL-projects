-- Case Study Questions
-- What is the total amount each customer spent at the restaurant?
-- How many days has each customer visited the restaurant?
-- What was the first item from the menu purchased by each customer?
-- What is the most purchased item on the menu and how many times was it purchased by all customers?
-- Which item was the most popular for each customer?
-- Which item was purchased first by the customer after they became a member?
-- Which item was purchased just before the customer became a member?
-- What is the total items and amount spent for each member before they became a member?
-- If each $1 spent equates to 10 points and sushi has a 2x points multiplier - how many points would each customer have?
-- In the first week after a customer joins the program (including their join date) they earn 2x points on all items, not just sushi - how many points do customer A and B have at the end of January?


-- Answers 

-- What is the total amount each customer spent at the restaurant?

select distinct customer_id , sum(price)
from sales as s join menu as m on s.product_id = m.product_id
group by customer_id;

+-------------+------------+
| customer_id | sum(price) |
+-------------+------------+
| A           |         76 |
| B           |         74 |
| C           |         36 |
+-------------+------------+

-- How many days has each customer visited the restaurant?

select distinct customer_id, count(order_date)
from sales 
group by customer_id;

+-------------+-------------------+
| customer_id | count(order_date) |
+-------------+-------------------+
| A           |                 6 |
| B           |                 6 |
| C           |                 3 |
+-------------+-------------------+

